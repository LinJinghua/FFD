# 1.赋予模拟体系力场参数
## 1.1力场参数
分子非范德华力场参数可以通过QuickFF获得，其文件格式为：
```
$ cat charmm22.prm 

BONDS
!
!V(bond) = Kb(b - b0)**2
!
!Kb: kcal/mole/A**2
!b0: A
!
!at1  at2        Kb         b0
!
C3_c1_n2 C4_c1_f3   337.395     1.4943
C3_c2_n1 C3_c2_n1   401.826     1.4268
C3_c2 H1_c   377.995     1.0942
C3_c2 C3_c2_n1   477.100     1.4014
C3_c1_n2 N3_c2_cu1   554.005     1.3474
C3_c2_n1 N3_c2_cu1   429.139     1.3981
C4_c1_f3 F1_c   388.016     1.3590
CU2_nn N3_c2_cu1   137.637     1.8768


ANGLES
!
!V(angle) = Ktheta(Theta - Theta0)**2
!
!V(Urey-Bradley) = Kub(S - S0)**2
!
!Ktheta: kcal/mole/rad**2
!Theta0: degrees
!Kub: kcal/mole/A**2 (Urey-Bradley)
!S0: A
!
!at1  at2  at3    Ktheta     Theta0     Kub     S0
!
C3_c1_n2 C4_c1_f3 F1_c    83.065   111.5197
F1_c C4_c1_f3 F1_c   110.159   106.7784
C4_c1_f3 C3_c1_n2 N3_c2_cu1    50.017   122.2738
N3_c2_cu1 C3_c1_n2 N3_c2_cu1    61.245   114.9450
C3_c2_n1 C3_c2_n1 N3_c2_cu1    55.327   108.0553
C3_c2 C3_c2_n1 N3_c2_cu1    55.456   129.7454
C3_c2 C3_c2_n1 C3_c2_n1    57.097   122.5555
C3_c2_n1 C3_c2 H1_c    33.065   123.0727
C3_c2_n1 C3_c2 C3_c2_n1    69.877   114.6445
C3_c1_n2 N3_c2_cu1 CU2_nn    17.668   128.9786
C3_c2_n1 N3_c2_cu1 CU2_nn    22.388   126.6148
C3_c1_n2 N3_c2_cu1 C3_c2_n1   113.305   104.3623


DIHEDRALS
!
!V(dihedral) = Kchi(1 + cos(n(chi) - delta))
!
!Kchi: kcal/mole
!n: multiplicity
!delta: degrees
!
!at1  at2  at3  at4       Kchi  n    delta
!
F1_c C4_c1_f3 C3_c1_n2 N3_c2_cu1     0.1442  6   180.00
C3_c2 C3_c2_n1 C3_c2_n1 N3_c2_cu1     2.1739  2   180.00
C3_c2 C3_c2_n1 C3_c2_n1 C3_c2     0.9739  2   180.00
H1_c C3_c2 C3_c2_n1 N3_c2_cu1     1.5784  2   180.00
C3_c2_n1 C3_c2_n1 C3_c2 H1_c     2.7067  2   180.00
C3_c2_n1 C3_c2 C3_c2_n1 N3_c2_cu1     4.2102  2   180.00
C3_c2_n1 C3_c2 C3_c2_n1 C3_c2_n1     4.4272  2   180.00
CU2_nn N3_c2_cu1 C3_c1_n2 N3_c2_cu1     0.0116  2   180.00
C3_c2_n1 N3_c2_cu1 C3_c1_n2 C4_c1_f3     2.9483  2   180.00
C3_c2_n1 N3_c2_cu1 C3_c1_n2 N3_c2_cu1     5.4952  2   180.00
C3_c2_n1 C3_c2_n1 N3_c2_cu1 CU2_nn     1.8114  2   180.00
C3_c2 C3_c2_n1 N3_c2_cu1 CU2_nn     0.4745  2   180.00
C3_c1_n2 N3_c2_cu1 C3_c2_n1 C3_c2_n1    13.2609  2   180.00
C3_c1_n2 N3_c2_cu1 C3_c2_n1 C3_c2     2.8586  2   180.00


IMPROPER
!
!V(improper) = Kpsi(psi - psi0)**2
!
!Kpsi: kcal/mole/rad**2
!psi0: degrees
!note that the second column of numbers (0) is ignored
!
!at1  at2  at3  at4   Kpsi        psi0
!
```
包括bond/angle/dihedrals/improper,分别表是键/角/二面角/不当二面角四个部分来约束一个分子的几何形状，这里需要知道该体系共有7种原子类型（C3_c2_n1/C3_c2_n2/C4_c1_f3/H1_c/F1_c/N3_c2_cu1/CU2_nn）,然后是8种键的类型，12种角的类型，14种二面角类型以及0种不当二面角类型，后面要的的便是对于任意规模的体系，能够根据输入文件的坐标以及键连信息，分别将上述的键/角/二面角/不当二面角进行编号和归类，然后输出为给定的格式（lammps/DL_POLY/GROMACS等）。

# 1.2 输入文件
该分子的输入文件有两个，分别是car（定义了分子的三维坐标）和mdf（定义了键连信息-分子中原子的连接顺序）文件。
```
$cat *.cat
!BIOSYM archive 3
PBC=ON
Materials Studio Generated CAR File
!DATE Thu Feb 21 22:53:41 2019
PBC   14.6830    8.2660   16.5540   90.0000   92.7670   90.0000 (P1)
N1       9.166907639    1.326610340    9.165349451 XXXX 1      xx      N   0.000
N2       7.689576055    0.764770320   10.798316404 XXXX 1      xx      N   0.000
F3       9.795081419    3.361286240   11.306427730 XXXX 1      xx      F   0.000
F4      11.069741629    1.583186980   11.302790096 XXXX 1      xx      F   0.000
F5       9.426648650    1.749994860   12.750237717 XXXX 1      xx      F   0.000
C6       9.781083027    2.004091700   11.468467788 XXXX 1      xx      C   0.000
C7       8.862516208    1.345456820   10.478039269 XXXX 1      xx      C   0.000
C8       8.104645768    0.667644820    8.559683397 XXXX 1      xx      C   0.000
C9       7.177595312    0.313198740    9.585826867 XXXX 1      xx      C   0.000
C10      5.987387314    7.899733540    9.321602364 XXXX 1      xx      C   0.000
H11      5.276316696    7.623979780   10.104851094 XXXX 1      xx      H   0.000
N12      1.825407639    5.459610340    9.165349451 XXXX 1      xx      N   0.000
N13      0.348076055    4.897770320   10.798316404 XXXX 1      xx      N   0.000
F14      2.453581419    7.494286240   11.306427730 XXXX 1      xx      F   0.000
F15      3.728241629    5.716186980   11.302790096 XXXX 1      xx      F   0.000
F16      2.085148650    5.882994860   12.750237717 XXXX 1      xx      F   0.000
C17      2.439583027    6.137091700   11.468467788 XXXX 1      xx      C   0.000
C18      1.521016208    5.478456820   10.478039269 XXXX 1      xx      C   0.000
C19      0.763145768    4.800644820    8.559683397 XXXX 1      xx      C   0.000
C20     -0.163904688    4.446198740    9.585826867 XXXX 1      xx      C   0.000
C21     13.328887314    3.766733540    9.321602364 XXXX 1      xx      C   0.000
H22     12.617816696    3.490979780   10.104851094 XXXX 1      xx      H   0.000
N23      4.317388483    1.326610340   15.636700263 XXXX 1      xx      N   0.000
N24      5.794720066    0.764770320   14.003733309 XXXX 1      xx      N   0.000
F25      3.689214703    3.361286240   13.495621984 XXXX 1      xx      F   0.000
F26      2.414554493    1.583269640   13.499259618 XXXX 1      xx      F   0.000
F27      4.057647471    1.749994860   12.051811997 XXXX 1      xx      F   0.000
C28      3.703213095    2.004091700   13.333581926 XXXX 1      xx      C   0.000
C29      4.621779914    1.345456820   14.324010445 XXXX 1      xx      C   0.000
C30      5.379650354    0.667727480   16.242366317 XXXX 1      xx      C   0.000
C31      6.306700809    0.313198740   15.216222846 XXXX 1      xx      C   0.000
C32      7.496908807    7.899733540   15.480447349 XXXX 1      xx      C   0.000
H33      8.207979426    7.623979780   14.697198619 XXXX 1      xx      H   0.000
N34     11.658888483    5.459610340   15.636700263 XXXX 1      xx      N   0.000
N35     13.136220066    4.897770320   14.003733309 XXXX 1      xx      N   0.000
F36     11.030714703    7.494286240   13.495621984 XXXX 1      xx      F   0.000
F37      9.756054493    5.716269640   13.499259618 XXXX 1      xx      F   0.000
F38     11.399147471    5.882994860   12.051811997 XXXX 1      xx      F   0.000
C39     11.044713095    6.137091700   13.333581926 XXXX 1      xx      C   0.000
C40     11.963279914    5.478456820   14.324010445 XXXX 1      xx      C   0.000
C41     12.721150354    4.800727480   16.242366317 XXXX 1      xx      C   0.000
C42     13.648200809    4.446198740   15.216222846 XXXX 1      xx      C   0.000
C43      0.155408807    3.766733540   15.480447349 XXXX 1      xx      C   0.000
H44      0.866479426    3.490979780   14.697198619 XXXX 1      xx      H   0.000
N45      4.716956442    6.939389660    7.369350358 XXXX 1      xx      N   0.000
N46      6.194288026    7.501229680    5.736383405 XXXX 1      xx      N   0.000
F47      4.088782662    4.904713760    5.228272080 XXXX 1      xx      F   0.000
F48      2.814122453    6.682730360    5.231909714 XXXX 1      xx      F   0.000
F49      4.457215431    6.516005140    3.784462092 XXXX 1      xx      F   0.000
C50      4.102781054    6.261908300    5.066232022 XXXX 1      xx      C   0.000
C51      5.021339882    6.920543180    6.056825887 XXXX 1      xx      C   0.000
C52      5.779218314    7.598355180    7.975016412 XXXX 1      xx      C   0.000
C53      6.706268769    7.952801260    6.948872942 XXXX 1      xx      C   0.000
C54      7.896476767    0.366266460    7.213097445 XXXX 1      xx      C   0.000
H55      8.607547385    0.642020220    6.429848715 XXXX 1      xx      H   0.000
N56     12.058456442    2.806389660    7.369350358 XXXX 1      xx      N   0.000
N57     13.535788026    3.368229680    5.736383405 XXXX 1      xx      N   0.000
F58     11.430282662    0.771713760    5.228272080 XXXX 1      xx      F   0.000
F59     10.155622453    2.549730360    5.231909714 XXXX 1      xx      F   0.000
F60     11.798715431    2.383005140    3.784462092 XXXX 1      xx      F   0.000
C61     11.444281054    2.128908300    5.066232022 XXXX 1      xx      C   0.000
C62     12.362839882    2.787543180    6.056825887 XXXX 1      xx      C   0.000
C63     13.120718314    3.465355180    7.975016412 XXXX 1      xx      C   0.000
C64     14.047768769    3.819801260    6.948872942 XXXX 1      xx      C   0.000
C65      0.554976767    4.499266460    7.213097445 XXXX 1      xx      C   0.000
H66      1.266047385    4.775020220    6.429848715 XXXX 1      xx      H   0.000
N67      9.566475598    6.939389660    0.897999547 XXXX 1      xx      N   0.000
N68      8.089144015    7.501229680    2.530966500 XXXX 1      xx      N   0.000
F69     10.194649378    4.904713760    3.039077825 XXXX 1      xx      F   0.000
F70     11.469309588    6.682813020    3.035440191 XXXX 1      xx      F   0.000
F71      9.826216610    6.516005140    4.482887812 XXXX 1      xx      F   0.000
C72     10.180650986    6.261908300    3.201117883 XXXX 1      xx      C   0.000
C73      9.262084168    6.920543180    2.210689365 XXXX 1      xx      C   0.000
C74      8.504213727    7.598355180    0.292333493 XXXX 1      xx      C   0.000
C75      7.577163272    7.952801260    1.318476963 XXXX 1      xx      C   0.000
C76      6.386955274    0.366266460    1.054252460 XXXX 1      xx      C   0.000
H77      5.675884655    0.642020220    1.837501190 XXXX 1      xx      H   0.000
N78      2.224975598    2.806389660    0.897999547 XXXX 1      xx      N   0.000
N79      0.747644015    3.368229680    2.530966500 XXXX 1      xx      N   0.000
F80      2.853149378    0.771713760    3.039077825 XXXX 1      xx      F   0.000
F81      4.127809588    2.549813020    3.035440191 XXXX 1      xx      F   0.000
F82      2.484716610    2.383005140    4.482887812 XXXX 1      xx      F   0.000
C83      2.839150986    2.128908300    3.201117883 XXXX 1      xx      C   0.000
C84      1.920584168    2.787543180    2.210689365 XXXX 1      xx      C   0.000
C85      1.162713727    3.465355180    0.292333493 XXXX 1      xx      C   0.000
C86      0.235663272    3.819801260    1.318476963 XXXX 1      xx      C   0.000
C87     13.728455274    4.499266460    1.054252460 XXXX 1      xx      C   0.000
H88     13.017384655    4.775020220    1.837501190 XXXX 1      xx      H   0.000
Cu89    10.612682041    2.066500000    8.267349905 XXXX 1      xx      Cu  0.000
Cu90     3.670750000    2.066500000    0.000000000 XXXX 1      xx      Cu  0.000
Cu91     3.271182041    6.199500000    8.267349905 XXXX 1      xx      Cu  0.000
Cu92    11.012250000    6.199500000    0.000000000 XXXX 1      xx      Cu  0.000
Cu93     6.742148061    0.729887800   12.401024857 XXXX 1      xx      Cu  0.000
Cu94    -0.599351939    4.862887800   12.401024857 XXXX 1      xx      Cu  0.000
Cu95     7.141716020    7.536112200    4.133674952 XXXX 1      xx      Cu  0.000
Cu96    -0.199783980    3.403112200    4.133674952 XXXX 1      xx      Cu  0.000
end
end
```
car文件的2/3/4列分别是xyz的坐标，7列是力场种的原子类型，8列是元素名，9列是电荷，这里需要做的是将力场种的7种原子类型分别写入到对应的7列中，比如前两个元素分别是N，对应的力场原子类型是N3_c2_cu1,依次类似，这里只有C有3种类型（C3_c2_n1/C3_c2_n2/C4_c1_f3）,因此需要定义区别的方式，这个区别主要根据连接的原子类型进行区别，因此需要键连信息，即mdf文件：

```
$ cat *.mdf
!BIOSYM molecular_data 4
 
!Date: Thu Feb 21 22:53:41 2019   Materials Studio Generated MDF file
 
#topology

@column 1 element
@column 2 atom_type
@column 3 charge_group
@column 4 isotope
@column 5 formal_charge
@column 6 charge
@column 7 switching_atom
@column 8 oop_flag
@column 9 chirality_flag
@column 10 occupancy
@column 11 xray_temp_factor
@column 12 connections
 
@molecule MAF_41_HT_SC_dmo
 
XXXX_1:N1           N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0489 Cu89 C7/1.5 C8/1.5 
XXXX_1:N2           N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0445 Cu93 C7/1.5 C9/1.5 
XXXX_1:F3           F  x       ?     0  0     0.0000 0 0 8 1.0000  0.0862 C6 
XXXX_1:F4           F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1342 C6 
XXXX_1:F5           F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1360 C6 
XXXX_1:C6           C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0635 F3 F4 F5 C7 
XXXX_1:C7           C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0464 N1/1.5 N2/1.5 C6 
XXXX_1:C8           C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0457 N1/1.5 C9/1.5 C54/1.5 
XXXX_1:C9           C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0437 N2/1.5 C8/1.5 C10%0-10#1 
XXXX_1:C10          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0444 H11 C52/1.5 C9%010#1 
XXXX_1:H11          H  x       ?     0  0     0.0000 0 0 8 1.0000  0.0530 C10 
XXXX_1:N12          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0489 Cu91 C18/1.5 C19/1.5 
XXXX_1:N13          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0445 Cu94 C18/1.5 C20/1.5 
XXXX_1:F14          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.0862 C17 
XXXX_1:F15          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1342 C17 
XXXX_1:F16          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1360 C17 
XXXX_1:C17          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0635 F14 F15 F16 C18 
XXXX_1:C18          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0464 N12/1.5 N13/1.5 C17 
XXXX_1:C19          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0457 N12/1.5 C20/1.5 C65/1.5 
XXXX_1:C20          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0437 N13/1.5 C19/1.5 C21%-100#1/1.5 
XXXX_1:C21          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0444 H22 C63/1.5 C20%100#1/1.5 
XXXX_1:H22          H  x       ?     0  0     0.0000 0 0 8 1.0000  0.0530 C21 
XXXX_1:N23          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0489 C29/1.5 C30/1.5 Cu90%001#1/1.5 
XXXX_1:N24          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0445 Cu93 C29/1.5 C31/1.5 
XXXX_1:F25          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.0862 C28 
XXXX_1:F26          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1342 C28 
XXXX_1:F27          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1360 C28 
XXXX_1:C28          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0635 F25 F26 F27 C29 
XXXX_1:C29          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0464 N23/1.5 N24/1.5 C28 
XXXX_1:C30          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0457 N23/1.5 C31/1.5 C76%001#1/1.5 
XXXX_1:C31          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0437 N24/1.5 C30/1.5 C32%0-10#1 
XXXX_1:C32          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0444 H33 C31%010#1 C74%001#1 
XXXX_1:H33          H  x       ?     0  0     0.0000 0 0 8 1.0000  0.0530 C32 
XXXX_1:N34          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0489 C40/1.5 C41/1.5 Cu92%001#1 
XXXX_1:N35          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0445 C40/1.5 C42/1.5 Cu94%100#1/1.5 
XXXX_1:F36          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.0862 C39 
XXXX_1:F37          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1342 C39 
XXXX_1:F38          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1360 C39 
XXXX_1:C39          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0635 F36 F37 F38 C40 
XXXX_1:C40          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0464 N34/1.5 N35/1.5 C39 
XXXX_1:C41          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0457 N34/1.5 C42/1.5 C87%001#1/1.5 
XXXX_1:C42          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0437 N35/1.5 C41/1.5 C43%100#1 
XXXX_1:C43          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0444 H44 C42%-100#1 C85%001#1 
XXXX_1:H44          H  x       ?     0  0     0.0000 0 0 8 1.0000  0.0530 C43 
XXXX_1:N45          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0489 Cu91 C51/1.5 C52/1.5 
XXXX_1:N46          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0445 Cu95 C51/1.5 C53/1.5 
XXXX_1:F47          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.0862 C50 
XXXX_1:F48          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1342 C50 
XXXX_1:F49          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1360 C50 
XXXX_1:C50          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0635 F47 F48 F49 C51 
XXXX_1:C51          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0464 N45/1.5 N46/1.5 C50 
XXXX_1:C52          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0457 C10/1.5 N45/1.5 C53/1.5 
XXXX_1:C53          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0437 N46/1.5 C52/1.5 C54%010#1/1.5 
XXXX_1:C54          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0444 C8/1.5 H55 C53%0-10#1/1.5 
XXXX_1:H55          H  x       ?     0  0     0.0000 0 0 8 1.0000  0.0530 C54 
XXXX_1:N56          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0489 Cu89 C62/1.5 C63/1.5 
XXXX_1:N57          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0445 C62/1.5 C64/1.5 Cu96%100#1 
XXXX_1:F58          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.0862 C61 
XXXX_1:F59          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1342 C61 
XXXX_1:F60          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1360 C61 
XXXX_1:C61          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0635 F58 F59 F60 C62 
XXXX_1:C62          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0464 N56/1.5 N57/1.5 C61 
XXXX_1:C63          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0457 C21/1.5 N56/1.5 C64/1.5 
XXXX_1:C64          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0437 N57/1.5 C63/1.5 C65%100#1/1.5 
XXXX_1:C65          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0444 C19/1.5 H66 C64%-100#1/1.5 
XXXX_1:H66          H  x       ?     0  0     0.0000 0 0 8 1.0000  0.0530 C65 
XXXX_1:N67          N  x       ?     0  1/2-  0.0000 0 0 8 1.0000  0.0489 Cu92 C73/1.5 C74/1.5 
XXXX_1:N68          N  x       ?     0  1/2-  0.0000 0 0 8 1.0000  0.0445 Cu95 C73/1.5 C75/1.5 
XXXX_1:F69          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.0862 C72 
XXXX_1:F70          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1342 C72 
XXXX_1:F71          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1360 C72 
XXXX_1:C72          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0635 F69 F70 F71 C73 
XXXX_1:C73          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0464 N67/1.5 N68/1.5 C72 
XXXX_1:C74          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0457 N67/1.5 C75/1.5 C32%00-1#1 
XXXX_1:C75          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0437 N68/1.5 C74/1.5 C76%010#1 
XXXX_1:C76          C  x       ?     0  1-    0.0000 0 0 8 1.0000  0.0444 H77 C30%00-1#1/1.5 C75%0-10#1 
XXXX_1:H77          H  x       ?     0  0     0.0000 0 0 8 1.0000  0.0530 C76 
XXXX_1:N78          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0489 Cu90 C84/1.5 C85/1.5 
XXXX_1:N79          N  x       ?     0  0     0.0000 0 0 8 1.0000  0.0445 Cu96 C84/1.5 C86/1.5 
XXXX_1:F80          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.0862 C83 
XXXX_1:F81          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1342 C83 
XXXX_1:F82          F  x       ?     0  0     0.0000 0 0 8 1.0000  0.1360 C83 
XXXX_1:C83          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0635 F80 F81 F82 C84 
XXXX_1:C84          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0464 N78/1.5 N79/1.5 C83 
XXXX_1:C85          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0457 N78/1.5 C86/1.5 C43%00-1#1 
XXXX_1:C86          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0437 N79/1.5 C85/1.5 C87%-100#1/1.5 
XXXX_1:C87          C  x       ?     0  0     0.0000 0 0 8 1.0000  0.0444 H88 C41%00-1#1/1.5 C86%100#1/1.5 
XXXX_1:H88          H  x       ?     0  0     0.0000 0 0 8 1.0000  0.0530 C87 
XXXX_1:Cu89         Cu x       ?     0  2+    0.0000 0 0 8 1.0000  0.0512 N1 N56 
XXXX_1:Cu90         Cu x       ?     0  2+    0.0000 0 0 8 1.0000  0.0512 N78 N23%00-1#1/1.5 
XXXX_1:Cu91         Cu x       ?     0  2+    0.0000 0 0 8 1.0000  0.0512 N12 N45 
XXXX_1:Cu92         Cu x       ?     0  2+    0.0000 0 0 8 1.0000  0.0512 N67 N34%00-1#1 
XXXX_1:Cu93         Cu x       ?     0  2+    0.0000 0 0 8 1.0000  0.0456 N2 N24 
XXXX_1:Cu94         Cu x       ?     0  2+    0.0000 0 0 8 1.0000  0.0456 N13 N35%-100#1/1.5 
XXXX_1:Cu95         Cu x       ?     0  2+    0.0000 0 0 8 1.0000  0.0456 N46 N68 
XXXX_1:Cu96         Cu x       ?     0  2+    0.0000 0 0 8 1.0000  0.0456 N79 N57%-100#1 
 
!
#symmetry
@periodicity 3 xyz
@group (P1)

#end

```
C3_c2_n1：键连信息中含有两个N；
C3_c2_n2：键联信息有一个N或没有N；
C4_c1_f3：最后一栏信息中，还有F的；

# 2.根据力场参数转换成lammps的输入文件
首先了解lammps输入文件中data的格式：
```
LAMMPS data file. msi2lmp v3.9.8 / 06 Oct 2016 / CGCMM for CuMOF-porous
#首先列举总体信息

     96 atoms
    112 bonds
    200 angles
    304 dihedrals
     48 impropers
     
#其次将上述总的信息（键、角等）归类
   8 atom types
  10 bond types
  19 angle types
  32 dihedral types
   8 improper types

#盒子的三维坐标
    -0.544191710    14.138808290 xlo xhi
     0.000001722     8.266001722 ylo yhi
    -0.172233012    16.362466798 zlo zhi
     0.000000000    -0.799135919     0.000000000 xy xz yz

#多少类type，并给质量参数
Masses

   1  14.006700 # np
   2  18.998400 # f
   3  12.011150 # c
   4  12.011150 # c5
   5   0.000000 # xx
   6   1.007970 # h
   7  12.011150 # cp
   8  63.546000 # Cu

#范德华力的参数
Pair Coeffs # lj/cut/coul/long

   1   0.1669999743   3.5012320066 # np
   2   0.0687685101   3.0808078941 # f
   3   0.1599999990   3.4745050026 # c
   4   0.1479999981   3.6170487995 # c5
   5   0.1479999981   3.6170487995 # xx
   6   0.0380000011   2.4499714540 # h
   7   0.1479999981   3.6170487995 # cp
   8   9.4389999720   2.3379999999 # Cu
   
#每类键的参数（注意种类数和上述第二栏信息是对应的）   
   Bond Coeffs # harmonic

   1     0.0000     0.0000 # np-Cu
   2   320.0000     1.3800 # np-c5
   3   496.0000     1.3630 # f-c
   4   283.0924     1.5100 # c-c5
   5   280.0000     1.3900 # c5-c5
   6   280.0000     1.3400 # c5-cp
   7     0.0000     0.0000 # c5-xx
   8   363.4164     1.0800 # xx-h
   9   363.4164     1.0800 # h-cp
  10   340.6175     1.1050 # c-h

#每类键的参数
Angle Coeffs # harmonic

   1    70.0000   128.8000 # c5-np-Cu
   2    75.1000   114.0000 # c5-np-c5
   3     0.0000     0.0000 # f-c-f
   4     0.0000     0.0000 # f-c-c5
   5   102.0000   134.0000 # np-c5-np
   6    50.0000   120.0000 # np-c5-c
   7    90.0000   120.0000 # np-c5-c5
   8    90.0000   120.0000 # np-c5-cp
   9    90.0000   120.0000 # c5-c5-cp
  10    90.0000   120.0000 # np-c5-xx
  11    90.0000   120.0000 # c5-c5-xx
  12    37.0000   120.0000 # c5-xx-h
  13    90.0000   120.0000 # c5-xx-c5
  14    37.0000   120.0000 # c5-cp-h
  15     0.0000     0.0000 # c5-cp-c5
  16    44.2000   120.0000 # c-c5-c5
  17    44.4000   110.0000 # c5-c-h
  18     0.0000     0.0000 # c5-c-c5
  19     0.0000     0.0000 # np-Cu-np

#二面角的参数
Dihedral Coeffs # harmonic

  1     0.0000   1   0 # c5-np-Cu-np
  2     1.0000  -1   2 # Cu-np-c5-np
  3     1.0000  -1   2 # Cu-np-c5-c
  4     1.0000  -1   2 # c5-np-c5-np
  5     1.0000  -1   2 # c5-np-c5-c
  6     1.0000  -1   2 # Cu-np-c5-c5
  7     1.0000  -1   2 # Cu-np-c5-cp
  8     1.0000  -1   2 # c5-np-c5-c5
  9     1.0000  -1   2 # c5-np-c5-cp
 10     1.0000  -1   2 # Cu-np-c5-xx
 11     1.0000  -1   2 # c5-np-c5-xx
 12     0.0000   1   2 # f-c-c5-np
 13     3.0000  -1   2 # np-c5-c5-np
 14     3.0000  -1   2 # np-c5-c5-xx
 15     3.0000  -1   2 # np-c5-c5-cp
 16     3.0000  -1   2 # xx-c5-c5-cp
 17     3.0000  -1   2 # np-c5-cp-h
 18     3.0000  -1   2 # np-c5-cp-c5
 19     3.0000  -1   2 # c5-c5-cp-h
 20     3.0000  -1   2 # c5-c5-cp-c5
 21     3.0000  -1   2 # np-c5-xx-h
 22     3.0000  -1   2 # np-c5-xx-c5
 23     3.0000  -1   2 # c5-c5-xx-h
 24     3.0000  -1   2 # c5-c5-xx-c5
 25     3.0000  -1   2 # cp-c5-c5-cp
 26     3.0000  -1   2 # np-c5-c5-c
 27     3.0000  -1   2 # c-c5-c5-xx
 28     0.0000   1   2 # h-c-c5-np
 29     0.0000   1   2 # c5-c-c5-np
 30     0.0000   1   2 # h-c-c5-c5
 31     0.6750   1   4 # c5-c-c5-c5
 32     3.0000  -1   2 # c-c5-c5-cp

#不当二面角的参数
Improper Coeffs # cvff

    1     0.3700  -1   2 # Cu-np-c5-c5
    2     0.0000   0   0 # np-c5-np-c
    3     0.3700  -1   2 # np-c5-c5-cp
    4     0.3700  -1   2 # np-c5-c5-xx
    5     0.3700  -1   2 # c5-xx-c5-h
    6     0.3700  -1   2 # c5-cp-c5-h
    7     0.3700  -1   2 # np-c5-c5-c
    8     0.0000   0   0 # c5-c-c5-h
  
#这里遍历所有的原子
#第一列是原子编号
#第二列是分子编号（连在一起就是一个分子，注意和mdf文件中的@molecule MAF_41_HT_SC_dmo信息是对应的，一个分子以@molecule MAF_41_HT_SC_dmo开头）
#第三列是原子种类和上述MASS是对应的
#第四列是电荷，这里需要和mdf第六列是对应的
#接下来三列是xyz坐标
#最后三列是周期性信息，如果x是1，表示这个原子在x+边长的盒子里面。
    Atoms # full

      1      1   1  0.000000     9.166907639     1.326610340     9.165349451   0   0   0 # np
      2      1   1  0.000000     7.689576055     0.764770320    10.798316404   0   0   0 # np
      3      1   2  0.000000     9.795081419     3.361286240    11.306427730   0   0   0 # f
      4      1   2  0.000000    11.069741629     1.583186980    11.302790096   0   0   0 # f
      5      1   2  0.000000     9.426648650     1.749994860    12.750237717   0   0   0 # f
      6      1   3  0.000000     9.781083027     2.004091700    11.468467788   0   0   0 # c
      7      1   4  0.000000     8.862516208     1.345456820    10.478039269   0   0   0 # c5
      8      1   4  0.000000     8.104645768     0.667644820     8.559683397   0   0   0 # c5
      9      1   4  0.000000     7.177595312     0.313198740     9.585826867   0   0   0 # c5
     10      1   5  0.000000     5.987387314     7.899733540     9.321602364   0   0   0 # xx
     11      1   6  0.000000     5.276316696     7.623979780    10.104851094   0   0   0 # h
     12      1   1  0.000000     1.825407639     5.459610340     9.165349451   0   0   0 # np
     ....
     
 #遍历所有的键
 #第一列：键的编号
 #第二列：键的种类
 #第三列：第一个原子的编号（该编号在上面的Atoms给出）
 #第四列：第二个原子的编号
     
     Bonds

     1   1      1     89
     2   2      1      7
     3   2      1      8
     4   1      2     93
     5   2      2      7
     6   2      2      9
     7   3      3      6
     8   3      4      6
     9   3      5      6
    10   4      6      7
    11   5      8      9
    12   6      8     54
    ....
 
 #遍历所有的角
 #第一列：角的编号
 #第二列：角的种类
 #第三列：第一个原子的编号
 #第四列：第二个原子的编号
 #第五列：第三个原子的编号
    Angles

     1   1      7      1     89
     2   1      8      1     89
     3   2      7      1      8
     4   1      7      2     93
     5   1      9      2     93
     6   2      7      2      9
     7   3      3      6      4
     8   3      3      6      5
     9   4      3      6      7
    10   3      4      6      5
    11   4      4      6      7
    12   4      5      6      7
    13   5      1      7      2
    14   6      1      7      6
    15   6      2      7      6
    ...
    
#遍历所有的二面角
#第一列：二面角的编号
#第二列：二面角的种类
#第三列：第一个原子的编号
#第四列：第二个原子的编号
#第五列：第三个原子的编号    
#第六列：第六个原子的编号 
    Dihedrals

     1   1      7      1     89     56
     2   1      8      1     89     56
     3   2     89      1      7      2
     4   3     89      1      7      6
     5   4      8      1      7      2
     6   5      8      1      7      6
     7   6     89      1      8      9
     8   7     89      1      8     54
     9   8      7      1      8      9
    10   9      7      1      8     54
    11   1      7      2     93     24
    12   1      9      2     93     24
    13   2     93      2      7      1
    14   3     93      2      7      6
    15   4      9      2      7      1
    ...
 #遍历所有的不当二面角
#第一列：不当二面角的编号
#第二列：不当二面角的种类
#第三列：第一个原子的编号
#第四列：第二个原子的编号
#第五列：第三个原子的编号    
#第六列：第六个原子的编号    
    Impropers

     1   1     89      1      7      8
     2   1     93      2      7      9
     3   2      1      7      2      6
     4   3      1      8      9     54
     5   4      2      9      8     10
     6   5     52     10      9     11
     7   1     91     12     18     19
     8   1     94     13     18     20
     9   2     12     18     13     17
    10   3     12     19     20     65
    11   3     13     20     19     21 
                                                       
```
需要写的代码是，首先遍历所有的原子类型（首先能识别原子类型，将已得到的力场类型给定到所选的体系），然后遍历键、角、二面角、不当二面角,然后算出总数，然后sort，算出类别：
build_bond_list -> count_bonds ->build_bonds_type;  
build_angles_list ->  count_angles -> build_angles_types;  
build_dihedrals_list -> count_dihedrals -> build_dihedrals_type;  
build_impropers_list -> count_impropers -> build_impropers_type;  

具体算法可以参考msi2lmp中的MakeLists.c文件。

最后按照lammps的data文件进行打印。
